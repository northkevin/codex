datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Podcast {
  id              Int       @id @default(autoincrement())
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  title           String
  url             String    @unique
  platform        String // youtube, spotify, etc.
  channelId       String?
  channelTitle    String?
  publishedAt     DateTime?
  durationSeconds Int?
  description     String?   @db.Text
  thumbnailUrl    String?
  viewCount       Int?
  likeCount       Int?
  watchedAt       DateTime?
  metadata        Json? // Additional platform-specific data
}

model Video {
  id           Int           @id @default(autoincrement())
  videoId      String        @unique @map("video_id") // YouTube's video ID
  title        String
  channelId    String?       @map("channel_id")
  channelTitle String?       @map("channel_title")
  publishedAt  DateTime?     @map("published_at")
  description  String?       @db.Text
  duration     Int?          // Duration in seconds
  viewCount    Int?          @map("view_count")
  createdAt    DateTime      @default(now()) @map("created_at")
  updatedAt    DateTime      @updatedAt @map("updated_at")
  watches      WatchHistory[]

  @@map("videos")
}

model WatchHistory {
  id        Int      @id @default(autoincrement())
  videoId   String   @map("video_id")
  watchedAt DateTime @map("watched_at")
  video     Video    @relation(fields: [videoId], references: [videoId])

  @@map("watch_history")
  @@index([videoId])
  @@index([watchedAt])
}
